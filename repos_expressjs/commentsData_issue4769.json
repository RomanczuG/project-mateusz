[
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/988557621",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-988557621",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 988557621,
    "node_id": "IC_kwDOAAOeZ8467DE1",
    "user": {
      "login": "dogemad",
      "id": 48283057,
      "node_id": "MDQ6VXNlcjQ4MjgzMDU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/48283057?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dogemad",
      "html_url": "https://github.com/dogemad",
      "followers_url": "https://api.github.com/users/dogemad/followers",
      "following_url": "https://api.github.com/users/dogemad/following{/other_user}",
      "gists_url": "https://api.github.com/users/dogemad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dogemad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dogemad/subscriptions",
      "organizations_url": "https://api.github.com/users/dogemad/orgs",
      "repos_url": "https://api.github.com/users/dogemad/repos",
      "events_url": "https://api.github.com/users/dogemad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dogemad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-08T07:13:33Z",
    "updated_at": "2021-12-08T07:13:33Z",
    "author_association": "NONE",
    "body": "Are you calling next on the endpoint of the above router? The given code alone doesn't seem to be able to pinpoint the problem.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/988557621/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/988917359",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-988917359",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 988917359,
    "node_id": "IC_kwDOAAOeZ8468a5v",
    "user": {
      "login": "jimburch",
      "id": 49823725,
      "node_id": "MDQ6VXNlcjQ5ODIzNzI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/49823725?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimburch",
      "html_url": "https://github.com/jimburch",
      "followers_url": "https://api.github.com/users/jimburch/followers",
      "following_url": "https://api.github.com/users/jimburch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimburch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimburch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimburch/subscriptions",
      "organizations_url": "https://api.github.com/users/jimburch/orgs",
      "repos_url": "https://api.github.com/users/jimburch/repos",
      "events_url": "https://api.github.com/users/jimburch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimburch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-08T15:31:22Z",
    "updated_at": "2021-12-08T15:31:22Z",
    "author_association": "NONE",
    "body": "> Are you calling next on the endpoint of the above router? The given code alone doesn't seem to be able to pinpoint the problem.\r\n\r\nI'm trying to call the `redirectRouter` with any page load, which technically is going through but then the same issue happens inside the router:\r\n\r\n```\r\nredirectRouter.get(\"*\", async (req: Request, res: Response) => {\r\n  // my code\r\n});\r\n```\r\n\r\nA `\"/\"` does nothing and a `\"*\"` prevents the site from loading.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/988917359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/990558894",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-990558894",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 990558894,
    "node_id": "IC_kwDOAAOeZ847Crqu",
    "user": {
      "login": "icepaq",
      "id": 62949848,
      "node_id": "MDQ6VXNlcjYyOTQ5ODQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/62949848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/icepaq",
      "html_url": "https://github.com/icepaq",
      "followers_url": "https://api.github.com/users/icepaq/followers",
      "following_url": "https://api.github.com/users/icepaq/following{/other_user}",
      "gists_url": "https://api.github.com/users/icepaq/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/icepaq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/icepaq/subscriptions",
      "organizations_url": "https://api.github.com/users/icepaq/orgs",
      "repos_url": "https://api.github.com/users/icepaq/repos",
      "events_url": "https://api.github.com/users/icepaq/events{/privacy}",
      "received_events_url": "https://api.github.com/users/icepaq/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-10T02:48:41Z",
    "updated_at": "2021-12-10T14:07:01Z",
    "author_association": "NONE",
    "body": "Edit: xjamundx answered this really well\r\n\r\n<s>I'm fairly new to express but have spent a lot of time with other routers like Spring. I believe that there's no way to activate two routes with one call since this goes against the basics of a router.\r\n\r\nI'm a little confused as to what you're trying to do here. Is it possible to run whatever backend code you want to do and then serve the react page? (Or at the same time by adding your backend code in an asynchronous function)\r\n</s>",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/990558894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/990642827",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-990642827",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 990642827,
    "node_id": "IC_kwDOAAOeZ847DAKL",
    "user": {
      "login": "xjamundx",
      "id": 246143,
      "node_id": "MDQ6VXNlcjI0NjE0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/246143?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xjamundx",
      "html_url": "https://github.com/xjamundx",
      "followers_url": "https://api.github.com/users/xjamundx/followers",
      "following_url": "https://api.github.com/users/xjamundx/following{/other_user}",
      "gists_url": "https://api.github.com/users/xjamundx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xjamundx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xjamundx/subscriptions",
      "organizations_url": "https://api.github.com/users/xjamundx/orgs",
      "repos_url": "https://api.github.com/users/xjamundx/repos",
      "events_url": "https://api.github.com/users/xjamundx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xjamundx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-10T06:02:53Z",
    "updated_at": "2021-12-10T06:08:23Z",
    "author_association": "NONE",
    "body": "@icepaq I believe that's incorrect. express can hit multiple routes. it's the basis for the \"middleware\" concept in express.  in order for that to happen the routes themselves need to call `next()` otherwise it will break the handler chain.  A good example of stringing together multiple handlers as middleware can be found here in the express docs:\r\nhttps://expressjs.com/en/4x/api.html#middleware-callback-function-examples\r\n\r\n---\r\n\r\nFor the OP there are three issues we need to work out:\r\n\r\n1. Does the matching `redirectRouter` handler call `next()`?\r\n2. In what order does express match the routes?\r\n3. When does `/` or `*` matter for the route?\r\n\r\n- The first question I can't answer, but I'm guessing it's the source of the problem.\r\n- The answer to the second question appears to be \"in the order they were attached to the router\". See https://stackoverflow.com/a/32604002/496735 for more information.\r\n- For the last question it looks like `app.use` and `app.get` have different behavior with regard to `/`. `app.use` will treat it as a start point and match anything after it whereas `app.get` will only match it exactly.  You can also leave off the path argument for that one `app.use(handler)` and it will assume `/` (all). `app.get(\"*\")` matches anything similar to `app.use(\"/\")`. A lot more information about this subtle difference can be found here:\r\nhttps://stackoverflow.com/a/32604002/496735\r\n\r\n\r\n---\r\n\r\nThis code right here works exactly as you'd expect it to. I'm guessing you're missing the `next()` in your middlewares!\r\n\r\n```js\r\nvar express = require(\"express\");\r\nvar app = express();\r\n\r\napp.use(\"/\", redirectRouter);\r\napp.use(\"/widgets\", widgetRouter);\r\napp.use(\"/api\", apiRouter);\r\n\r\napp.listen(9999);\r\n\r\nfunction redirectRouter(req, res, next) {\r\n        console.log(\"redirects\");\r\n        next();\r\n}\r\n\r\nfunction widgetRouter(req, res, next) {\r\n        console.log(\"widgets\");\r\n        next();\r\n}\r\n\r\nfunction apiRouter(req, res, next) {\r\n        console.log(\"api\");\r\n        next();\r\n}\r\n\r\napp.use((req, res) => {\r\n        console.log(\"final route\");\r\n        res.send(\"OK\");\r\n});\r\n```\r\n \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/990642827/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/1014717321",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-1014717321",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 1014717321,
    "node_id": "IC_kwDOAAOeZ848e1uJ",
    "user": {
      "login": "geekhunger",
      "id": 1267980,
      "node_id": "MDQ6VXNlcjEyNjc5ODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1267980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geekhunger",
      "html_url": "https://github.com/geekhunger",
      "followers_url": "https://api.github.com/users/geekhunger/followers",
      "following_url": "https://api.github.com/users/geekhunger/following{/other_user}",
      "gists_url": "https://api.github.com/users/geekhunger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geekhunger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geekhunger/subscriptions",
      "organizations_url": "https://api.github.com/users/geekhunger/orgs",
      "repos_url": "https://api.github.com/users/geekhunger/repos",
      "events_url": "https://api.github.com/users/geekhunger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geekhunger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-17T16:31:44Z",
    "updated_at": "2022-01-17T16:31:44Z",
    "author_association": "NONE",
    "body": "@JimBurch please see what @xjamundx says...\r\n\r\n**A note about requests:**\r\n\r\nEvery middleware MUST call EITHER: next(), next(\"route\"), next(\"error message\"), throw new Error(), response.end(), response.send() --- or something similar.\r\n\r\nYou either handle the request and respond within the same handler that received the request, or you pass that request forward to another middleware/route/error handler.\r\n\r\nIf you don't do that, then your application will freeze as soon as the request hits that handler. (At some point it will maybe release (or rather drop) it due to a timeout, but until then it does not respond to it and does not continue with execution.. so it is simply... stuck.)\r\n\r\nIf your `redirectRouter` is an instance of `express` or `express.Router` then make sure that it looks something like this:\r\n\r\n```js\r\nconst express = require(\"express\")\r\nlet router = module.exports = express.Router()\r\n\r\nrouter.get(\"/\", (req, res, nxt) => {\r\n    // do something with the request and respond or throw error, or pass to next middleware/route\r\n    console.log(req)\r\n    nxt() // forward the request if you don't want to send a response just yet...\r\n})\r\n```\r\n\r\n**Another note about your use-case:**\r\n\r\nIf you want to fire `redirectRouter` for **every** path (not just '/') then omit the path and just `app.use(redirectRouter)`. And if it does *not* have to run *before* the route handlers then why not do it like this?\r\n\r\n```js\r\nconst app = express();\r\n\r\napp.use(\"/widgets\", widgetRouter);\r\napp.use(\"/api\", apiRouter);\r\n\r\napp.use(redirectRouter, (req: Request, res: Response) => {  // <----------- your middleware\r\n  res.sendFile(path.join(__dirname, \"public\", \"index.html\"));\r\n});\r\n```\r\n\r\nIf you *need* to run it *before* the route handlers (/widget, /api) then your code is ok, but then remove the path '/' anyways and make sure to 'fall-through your redirectRouter' by calling `next()` inside every handler of your redirectRouter middleware chain.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/1014717321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/1065307267",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-1065307267",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 1065307267,
    "node_id": "IC_kwDOAAOeZ84_f0yD",
    "user": {
      "login": "textbook-haroon",
      "id": 97704907,
      "node_id": "U_kgDOBdLbyw",
      "avatar_url": "https://avatars.githubusercontent.com/u/97704907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/textbook-haroon",
      "html_url": "https://github.com/textbook-haroon",
      "followers_url": "https://api.github.com/users/textbook-haroon/followers",
      "following_url": "https://api.github.com/users/textbook-haroon/following{/other_user}",
      "gists_url": "https://api.github.com/users/textbook-haroon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/textbook-haroon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/textbook-haroon/subscriptions",
      "organizations_url": "https://api.github.com/users/textbook-haroon/orgs",
      "repos_url": "https://api.github.com/users/textbook-haroon/repos",
      "events_url": "https://api.github.com/users/textbook-haroon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/textbook-haroon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-11T17:03:43Z",
    "updated_at": "2022-03-11T17:03:43Z",
    "author_association": "NONE",
    "body": "Thanks so much, @geekhunger! I have never seen the router call sequence in this light.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/1065307267/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/1079848669",
    "html_url": "https://github.com/expressjs/express/issues/4769#issuecomment-1079848669",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4769",
    "id": 1079848669,
    "node_id": "IC_kwDOAAOeZ85AXS7d",
    "user": {
      "login": "dougwilson",
      "id": 67512,
      "node_id": "MDQ6VXNlcjY3NTEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/67512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dougwilson",
      "html_url": "https://github.com/dougwilson",
      "followers_url": "https://api.github.com/users/dougwilson/followers",
      "following_url": "https://api.github.com/users/dougwilson/following{/other_user}",
      "gists_url": "https://api.github.com/users/dougwilson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dougwilson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dougwilson/subscriptions",
      "organizations_url": "https://api.github.com/users/dougwilson/orgs",
      "repos_url": "https://api.github.com/users/dougwilson/repos",
      "events_url": "https://api.github.com/users/dougwilson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dougwilson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-27T06:12:35Z",
    "updated_at": "2022-03-27T06:12:35Z",
    "author_association": "MEMBER",
    "body": "All the above are great answers! I'm going to close this as we haven't heard back further from the OP.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/1079848669/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]