[
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/697345601",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-697345601",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 697345601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzM0NTYwMQ==",
    "user": {
      "login": "rodion-arr",
      "id": 5843270,
      "node_id": "MDQ6VXNlcjU4NDMyNzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5843270?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodion-arr",
      "html_url": "https://github.com/rodion-arr",
      "followers_url": "https://api.github.com/users/rodion-arr/followers",
      "following_url": "https://api.github.com/users/rodion-arr/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodion-arr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodion-arr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodion-arr/subscriptions",
      "organizations_url": "https://api.github.com/users/rodion-arr/orgs",
      "repos_url": "https://api.github.com/users/rodion-arr/repos",
      "events_url": "https://api.github.com/users/rodion-arr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodion-arr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T12:55:05Z",
    "updated_at": "2020-09-23T12:55:05Z",
    "author_association": "MEMBER",
    "body": "Hi @freeman-g,\r\n\r\n`mergeParams` option on Router was indeed added in v4.5.\r\nHere is a working example from `express` [tests](https://github.com/expressjs/express/blob/b8e50568af9c73ef1ade434e92c60d389868361d/test/app.router.js#L251):\r\n```javascript\r\nvar express = require('express');\r\n\r\nvar app = express();\r\nvar router = new express.Router({ mergeParams: true });\r\n\r\nrouter.get('/:action', function(req, res){\r\n  var keys = Object.keys(req.params).sort();\r\n  res.send(keys.map(function(k){ return [k, req.params[k]] }));\r\n});\r\n\r\napp.use('/user/:user', router);\r\n```\r\n\r\nGET request to `/user/tj/get` will return:\r\n```json\r\n[\r\n  [\r\n    \"action\",\r\n    \"get\"\r\n  ],\r\n  [\r\n    \"user\",\r\n    \"tj\"\r\n  ]\r\n]\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/697345601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/697349880",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-697349880",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 697349880,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzM0OTg4MA==",
    "user": {
      "login": "freeman-g",
      "id": 495886,
      "node_id": "MDQ6VXNlcjQ5NTg4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/495886?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/freeman-g",
      "html_url": "https://github.com/freeman-g",
      "followers_url": "https://api.github.com/users/freeman-g/followers",
      "following_url": "https://api.github.com/users/freeman-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/freeman-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/freeman-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/freeman-g/subscriptions",
      "organizations_url": "https://api.github.com/users/freeman-g/orgs",
      "repos_url": "https://api.github.com/users/freeman-g/repos",
      "events_url": "https://api.github.com/users/freeman-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/freeman-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T13:02:47Z",
    "updated_at": "2020-09-23T13:02:47Z",
    "author_association": "NONE",
    "body": "Thank you, a couple more questions. \r\n\r\nIs 4.5 actually a lower version than 4.17?  On NPM I see that 4.5 was published 6 years ago whereas 4.17 was published 1 year ago. \r\n\r\nIs there any way to achieve mergeParams in 4.17?",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/697349880/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/697453529",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-697453529",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 697453529,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzQ1MzUyOQ==",
    "user": {
      "login": "krzysdz",
      "id": 12915102,
      "node_id": "MDQ6VXNlcjEyOTE1MTAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/12915102?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krzysdz",
      "html_url": "https://github.com/krzysdz",
      "followers_url": "https://api.github.com/users/krzysdz/followers",
      "following_url": "https://api.github.com/users/krzysdz/following{/other_user}",
      "gists_url": "https://api.github.com/users/krzysdz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krzysdz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krzysdz/subscriptions",
      "organizations_url": "https://api.github.com/users/krzysdz/orgs",
      "repos_url": "https://api.github.com/users/krzysdz/repos",
      "events_url": "https://api.github.com/users/krzysdz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krzysdz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T14:33:26Z",
    "updated_at": "2020-09-23T16:04:44Z",
    "author_association": "NONE",
    "body": "@freeman-g  You have to add `{ mergeParams: true }` when creating the router in which you want to use `mergeParams`, not the parent one. You can remove `{ mergeParams: true }` from the router in `app.js`, but you have to add it in `lunchWeekRouter.js`. \r\n\r\nSee this working example based on your code (express 4.17.1):\r\n\r\n`app.js`\r\n```js\r\nconst http = require(\"http\");\r\nconst express = require(\"express\");\r\nconst lunchWeekRouter = require(\"./lunchWeekRouter.js\");\r\n\r\nfunction authenticateJwt(_req, _res, next) { console.log(\"auth 1\"); next(); }\r\nfunction authenticateSchool(_req, _res, next) { console.log(\"auth 2\"); next(); }\r\n\r\nconst app = express();\r\nconst router = express.Router() // Removed mergeParams as it's not necessary. Leaving it won't break anything\r\n\r\n// router.use('/', indexRouter)\r\n// router.use('/users', usersRouter)\r\nrouter.use('/:schoolId/lunch-week', [authenticateJwt, authenticateSchool], lunchWeekRouter)\r\napp.use('/api', router)\r\n\r\nconst server = app.listen(0, () => { // test code\r\n\thttp.get(`http://localhost:${server.address().port}/api/1234/lunch-week/`, (res) => {\r\n\t\tres.on('data', buff => console.log(buff.toString()));\r\n\t\tres.on('end', () => {\r\n\t\t\tserver.close();\r\n\t\t});\r\n\t});\r\n});\r\n```\r\n\r\n`lunchWeekRouter.js`:\r\n```js\r\nconst express = require(\"express\");\r\n\r\nasync function getLunchWeekList(schoolId) {\r\n\treturn `Data for school ${schoolId}.`;\r\n}\r\n\r\nconst router = new express.Router({ mergeParams: true }); // IMPORTANT! Here mergeParams must be set\r\n\r\nrouter.get('/', async function (req, res) {\r\n\tconsole.log(req.params)\r\n\t// It works!\r\n\tconst schoolId = parseInt(req.params.schoolId)\r\n\ttry {\r\n\t\tconst lunchWeekList = await getLunchWeekList(schoolId)\r\n\t\tres.send(lunchWeekList)\r\n\t} catch (e) {\r\n\t\tconst message = `Error getting Lunch Week List`\r\n\t\tres.status(500).send({ message: message, error: e.toString() })\r\n\t}\r\n})\r\n\r\nmodule.exports = router;\r\n```\r\n\r\n![Screenshot of a working example with code and result](https://user-images.githubusercontent.com/12915102/94026851-7c565b00-fdba-11ea-9519-c16508f8bf8b.png)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/697453529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/697491253",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-697491253",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 697491253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzQ5MTI1Mw==",
    "user": {
      "login": "freeman-g",
      "id": 495886,
      "node_id": "MDQ6VXNlcjQ5NTg4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/495886?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/freeman-g",
      "html_url": "https://github.com/freeman-g",
      "followers_url": "https://api.github.com/users/freeman-g/followers",
      "following_url": "https://api.github.com/users/freeman-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/freeman-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/freeman-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/freeman-g/subscriptions",
      "organizations_url": "https://api.github.com/users/freeman-g/orgs",
      "repos_url": "https://api.github.com/users/freeman-g/repos",
      "events_url": "https://api.github.com/users/freeman-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/freeman-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T14:56:12Z",
    "updated_at": "2020-09-23T14:56:12Z",
    "author_association": "NONE",
    "body": "Ah, I see, thank you! I will give that a try. ",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/697491253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/698175481",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-698175481",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 698175481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODE3NTQ4MQ==",
    "user": {
      "login": "rodion-arr",
      "id": 5843270,
      "node_id": "MDQ6VXNlcjU4NDMyNzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5843270?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodion-arr",
      "html_url": "https://github.com/rodion-arr",
      "followers_url": "https://api.github.com/users/rodion-arr/followers",
      "following_url": "https://api.github.com/users/rodion-arr/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodion-arr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodion-arr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodion-arr/subscriptions",
      "organizations_url": "https://api.github.com/users/rodion-arr/orgs",
      "repos_url": "https://api.github.com/users/rodion-arr/repos",
      "events_url": "https://api.github.com/users/rodion-arr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodion-arr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T07:43:21Z",
    "updated_at": "2020-09-24T11:12:56Z",
    "author_association": "MEMBER",
    "body": "@freeman-g, I'm closing this as I believe answers were provided and it's not looks like an issue with `express`",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/698175481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/expressjs/express/issues/comments/698274696",
    "html_url": "https://github.com/expressjs/express/issues/4415#issuecomment-698274696",
    "issue_url": "https://api.github.com/repos/expressjs/express/issues/4415",
    "id": 698274696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI3NDY5Ng==",
    "user": {
      "login": "freeman-g",
      "id": 495886,
      "node_id": "MDQ6VXNlcjQ5NTg4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/495886?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/freeman-g",
      "html_url": "https://github.com/freeman-g",
      "followers_url": "https://api.github.com/users/freeman-g/followers",
      "following_url": "https://api.github.com/users/freeman-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/freeman-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/freeman-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/freeman-g/subscriptions",
      "organizations_url": "https://api.github.com/users/freeman-g/orgs",
      "repos_url": "https://api.github.com/users/freeman-g/repos",
      "events_url": "https://api.github.com/users/freeman-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/freeman-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T11:04:28Z",
    "updated_at": "2020-09-24T11:04:28Z",
    "author_association": "NONE",
    "body": "Yes it worked, thank you. For any one else who lands here, mergeParams does work in 4.17, just make sure you use it on the sub router instance and not on the parent router instance in app.js.",
    "reactions": {
      "url": "https://api.github.com/repos/expressjs/express/issues/comments/698274696/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]